# âš½ Soccer Object Detection Performance Optimization

YOLOv8 ê¸°ë°˜ ì¶•êµ¬ ê²½ê¸° ì˜ìƒ ë‚´ ê°ì²´ íƒì§€ ì„±ëŠ¥ ìµœì í™” ë¶„ì„ ì‹¤í—˜

## 1. í”„ë¡œì íŠ¸ ê°œìš”

ë³¸ í”„ë¡œì íŠ¸ëŠ” ì¶•êµ¬ ê²½ê¸° ì˜ìƒì—ì„œ ì„ ìˆ˜, ê³µ, ì‹¬íŒ ë“±ì˜ ê°ì²´ë¥¼ ì •í™•í•˜ê²Œ íƒì§€í•˜ê¸° ìœ„í•´ **'ëª¨ë¸ í¬ê¸°'**ì™€ **'ì…ë ¥ í•´ìƒë„'**ê°€ ì„±ëŠ¥ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ì‹¤í—˜ì ìœ¼ë¡œ 'ë¹„êµ ë¶„ì„'í•©ë‹ˆë‹¤.

## 2. ì‹¤í—˜ ëª©ì 

ëª¨ë¸ í¬ê¸°(Yolov8n vs Yolov8s)ì™€ ì´ë¯¸ì§€ í•´ìƒë„(640 vs 1280)ì˜ ë³€í™”ê°€ ì¶•êµ¬ ê²½ê¸° ë‚´ ì†Œí˜• ì´ë¯¸ì§€ ê°ì²´(ê³µ, ì„ ìˆ˜) íƒì§€ ì •í™•ë„(mAP50)ì— ë¯¸ì¹˜ëŠ” ì¸ê³¼ê´€ê³„ë¥¼ ë¹„êµí•˜ì—¬ ë¶„ì„í•©ë‹ˆë‹¤.

## 3. ì‹¤í—˜ í™˜ê²½

### Dataset
- **ì¶œì²˜**: SelectStar Fitogether ì¶•êµ¬ ë°ì´í„°
- **ë°ì´í„°ì…‹ ë§í¬** : https://open.selectstar.ai/ko/fitogether
- **ë°ì´í„° íŒŒì¼** : fittogether.zip (ì•½ 3.4 GB)
- **íŒŒì¼ ìˆ˜**: *.json, *.jpg íŒŒì¼ ê°ê° 11,150ê°œ
- **í´ë˜ìŠ¤ ì •ì˜**:
  - `B` (Ball): ì¶•êµ¬ê³µ
  - `Ta` (Team A): AíŒ€ ì„ ìˆ˜
  - `Tb` (Team B): BíŒ€ ì„ ìˆ˜
  - `R` (Referee): ì‹¬íŒ
  - `O` (Others): ê¸°íƒ€ ê°ì²´

### Local PCì˜ GPU í™œìš©
- VScodeì—ì„œ Google Colab ì‹¤í–‰ -> local PCì˜ ì¥ì¹˜ í™•ì¸: cuda í™œìš©
 -> GPU ëª¨ë¸: NVIDIA GeForce RTX 4070 Laptop GPU

### Models & Configurations (Epochs = 50)
| Model | Resolution | Batch Size | Early Stopping |
|-------|-----------|------------|----------------|
| YOLOv8n | 640px | AutoBatch (-1) | patience=5 |
| YOLOv8s | 640px | AutoBatch (-1) | patience=5 |
| YOLOv8s | 1280px | AutoBatch (-1) | patience=5 |

## 4. ì‹¤í—˜ ê²°ê³¼

### ì •ëŸ‰ì  ì„±ëŠ¥ ë¶„ì„

ğŸ”[Performance Analysis]

<img width="1400" height="800" alt="Step_Comparison_E50" src="https://github.com/user-attachments/assets/47b2741c-01c2-441e-a833-34c8ac55fe32" />


**âœ…ì£¼ìš” ë°œê²¬ì‚¬í•­**:

1. **í•´ìƒë„ì˜ ê²°ì •ì  ì˜í–¥**: 
   - `yolov8s_SZ1280` ëª¨ë¸ì´ **mAP50 0.6 ì´ìƒ** ë‹¬ì„±
   - 640 í•´ìƒë„ ëª¨ë¸ë“¤ì€  mAP500 = 0.4 ~ 0.5 êµ¬ê°„ì—ì„œ ìˆ˜ë ´

2. **ëª¨ë¸ ê·œëª¨ì˜ ì˜í–¥**:
   - ì´ë¯¸ì§€ê°€ ë™ì¼í•œ 640 í•´ìƒë„ì—ì„œ YOLOv8sê°€ YOLOv8në³´ë‹¤ **ì•½ 10% ë†’ì€ ì •í™•ë„** ë¥¼ ê°€ì§„ë‹¤.

3. **ìˆ˜ë ´ ì†ë„**:
   - ê³ í•´ìƒë„ ëª¨ë¸ì€ **10 Epoch ì´ë‚´**ì— ëª©í‘œ ì„±ëŠ¥(0.5) ë‹¬ì„±


### ì •ì„±ì  íƒì§€ ê²°ê³¼

ğŸ”[Detection Results Comparison]

<img width="768" height="979" alt="Resolution_Comparison_Result" src="https://github.com/user-attachments/assets/5ee30734-b3f0-4f34-acbd-57a64d7469c4" />


**âœ…ì‹œê°ì  ë¶„ì„**:

- **ë¶„í•´ëŠ¥ í–¥ìƒ**: 1280 í•´ìƒë„ì—ì„œ ì›ê±°ë¦¬ ì„ ìˆ˜ ë° ì†Œí˜• ì¶•êµ¬ê³µ íƒì§€ ì„±ëŠ¥ ëŒ€í­ ê°œì„ 
- **ì‹ ë¢°ë„ ì¦ê°€**: ê³ í•´ìƒë„ ì…ë ¥ìœ¼ë¡œ ì¸í•œ Confidence Score ì „ë°˜ì  ìƒìŠ¹
- **ì†Œí˜• ê°ì²´ ì†ì‹¤ ë°©ì§€**: 640ì—ì„œ ëˆ„ë½ë˜ë˜ ì›ê±°ë¦¬ ê°ì²´ë“¤ì´ 1280ì—ì„œ ì •í™•íˆ ë¶„ë¥˜

## 5. ì •ë¦¬

### 1. í•´ìƒë„ ì„ê³„ê°’ì˜ ì¤‘ìš”ì„±
ì¶•êµ¬ì™€ ê°™ì€ **ê´‘ê° ì´¬ì˜ ì˜ìƒ**ì—ì„œëŠ” ëª¨ë¸ í¬ê¸°ë¥¼ ëŠ˜ë¦¬ëŠ” ê²ƒë³´ë‹¤ **ì…ë ¥ í•´ìƒë„ë¥¼ 1280 ì´ìƒ**ìœ¼ë¡œ í™•ë³´í•˜ëŠ” ê²ƒì´ ì„±ëŠ¥ í–¥ìƒì— ë” ì§€ë°°ì ì¸ ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤.

### 2. ì—°ì‚° íš¨ìœ¨ì„±
YOLOv8s ëª¨ë¸ì€ Nano ëŒ€ë¹„ ì•½ê°„ì˜ ì—°ì‚°ëŸ‰ ì¦ê°€ë§Œìœ¼ë¡œë„ ìœ ì˜ë¯¸í•œ ì •í™•ë„ ì´ë“ì„ ì œê³µí•˜ë¯€ë¡œ, **ì‹¤ì‹œê°„ì„±ì´ ë³´ì¥ë˜ëŠ” í•œ Smallê¸‰ ì´ìƒì˜ ëª¨ë¸ ì‚¬ìš© ê¶Œì¥**

### 3. í–¥í›„ ê°œì„  ë°©í–¥
- í˜„ì¬ ID ê¸°ë°˜ ì„ì‹œ íŒ€ ë¶„ë¥˜(í™€ì§)ë¥¼ **ìœ ë‹ˆí¼ ìƒ‰ìƒ íˆìŠ¤í† ê·¸ë¨ ë¶„ì„** ê¸°ë°˜ìœ¼ë¡œ ì „í™˜
  -> `Ta`ì™€ `Tb`ì˜ ì˜¤ë¶„ë¥˜ìœ¨ ê°ì†Œ ì˜ˆìƒ
- ë³¸ í”„ë¡œì íŠ¸ì—ì„œëŠ” ì „ì²´ ë°ì´í„°ì…‹ì˜ 10% ë§Œ í•™ìŠµí–ˆìœ¼ë¯€ë¡œ, ë°ì´í„°ì…‹ ëª¨ë‘ë¥¼ í•™ìŠµí•˜ì—¬ ì¶”ê°€ ê²°ê³¼ë¥¼ ë¹„êµí•˜ëŠ” ê³¼ì œê°€ ê°€ëŠ¥í•˜ë‹¤.
  -> íŠ¹íˆ, ë” ë§ì€ ìˆ˜ì˜ 1280 í•´ìƒë„ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ë©´, ìƒëŒ€ì ìœ¼ë¡œ ì‘ì€ ì´ë¯¸ì§€ ê°ì²´ì¸ ì¶•êµ¬ê³µ(Ball)ì˜ íƒì§€ì— ëŒ€í•œ í•™ìŠµì´ ë” ì˜ ë  ê²ƒìœ¼ë¡œ ì˜ˆìƒí•œë‹¤.

## 6. ì‚¬ìš© ë°©ë²•

```bash
# í™˜ê²½ ì„¤ì •
pip install ultralytics

# í•™ìŠµ ì‹¤í–‰ (ì˜ˆì‹œ)
yolo detect train data=soccer.yaml model=yolov8s.pt imgsz=1280 epochs=50 patience=5 batch=-1

# ì¶”ë¡  ì‹¤í–‰
yolo detect predict model=best.pt source=test_video.mp4 imgsz=1280
```

## 7. í”„ë¡œì íŠ¸ êµ¬ì¡°

```
soccer-object-detection/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ train/
â”‚   â”œâ”€â”€ val/
â”‚   â””â”€â”€ soccer.yaml
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ yolov8n_640/
â”‚   â”œâ”€â”€ yolov8s_640/
â”‚   â””â”€â”€ yolov8s_1280/
â”œâ”€â”€ results/
â”‚   â”œâ”€â”€ performance_graph.png
â”‚   â””â”€â”€ detection_comparison.png
â””â”€â”€ README.md
```

## 8. ì°¸ê³  ë¬¸í—Œ

- [Ultralytics YOLOv8 Documentation](https://docs.ultralytics.com/)
- [SelectStar Fitogether Dataset](https://selectstar.ai/)

---
